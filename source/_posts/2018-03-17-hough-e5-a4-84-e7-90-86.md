---
title: Hough处理
url: 1271.html
id: 1271
categories:
  - IT·Q
tags:
  - OpenCV
---

使用openCV对图像进行处理的基础，就是要分析图像中的点线面，常用到的工具函数包括提取边缘轮廓的Canny算法，检测直线的HoughLines，和针对其改进的线段检测HoughLinesP，对圆进行检测的HoughCircles等。 如果是基于python的OpenCV，针对上述函数的调用还是比较简单的，需要注意的是输入参数个数和对应关系，还有不同的输出参数形式，可以注意到所有的霍夫函数都是带s，所以输出不是针对性的目标有无。 img = cv2.imread('I:\\cv\\test.jpg') edges = cv2.Canny(img, 50, 150, apertureSize = 3) lines = cv2.HoughLines(edges, 1, np.pi/180, 100,50,10) 接收到的结果lines，类型是三维数组，网上很多“无良”博主在没有自己验证的情况下，通常只能接收第一组数据，如： for rho,theta in lines\[0\]： for x1,y1,x2,y2 in lines\[0\]: 这样的结果对新手可能是迷茫的，因为第一组数据不一定明显，所以把处理后的图像显示出来可能观察不到标识的图像。 还有一点就是HoughLines检测输出的是三维数组，最内侧单元包含两个元素（极坐标），通过极坐标确认的是直线；而HoughLinesP输出的三维数组，最内层单元包含4个元素（直角坐标），确定的是一条线段。 对于直角坐标点，通过cv2.line(img,(x1,y1),(x2,y2),(255,0,0),1)可直接确定线段。 对于极坐标点（rho，theta）需要进行简单的坐标变换，同时将浮点数变为取整： a = np.cos(theta) b = np.sin(theta) x0 = a\*rho y0 = b\*rho x1 = int(x0 + 1000*(-b)) y1 = int(y0 + 1000*(a)) x2 = int(x0 - 1000*(-b)) y2 = int(y0 - 1000*(a)) 然后通过直线确定线段： cv2.line(img,(x1,y1),(x2,y2),(255,0,0),1) cv2.HoughCircles(img,cv2.HOUGH_GRADIENT,1,120,param1,param2,minRadius,maxRadius) 第一个参数img输入图像，第二个参数method检测方法，目前OpenCV中就霍夫梯度法一种可以使用。第三个参数用来检测圆心的累加器图像分辨率于输入图像之比的倒数，例如=1时，累加器和输入图像具有相同的分辨率。如果=2，累加器便有输入图像一半那么大的宽度和高度。 第四个参数为霍夫变换检测到的圆心之间的最小距离，即让算法能明显区分的两个不同圆之间的最小距离。这个参数如果太小的话，多个相邻的圆可能被错误地检测成了一个重合的圆。 第五个参数param1，默认值100，是第三个参数method设置的检测方法对应参数。对当前唯一的霍夫梯度法它表示传递给canny边缘检测算子的高阈值（低阈值默认为高阈值的一半）。 第六个参数param2，默认值100，是第三个参数method设置的检测方法对应参数。对当前唯一的霍夫梯度法它表示在检测阶段圆心的累加器阈值，它越小的话，就可以检测到更多根本不存在的圆。 第七个参数minRadius，默认值0，表示圆半径的最小值。 第八个参数maxRadius，默认值0，表示圆半径的最大值。