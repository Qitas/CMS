---
title: struct模块
url: 1386.html
id: 1386
categories:
  - I·TQ
tags:
  - python
  - 编程
---

python中的struct主要是用来处理C语言结构数据，读入时先转换为Python的字符串类型，然后再转换为Python的结构化类型，比如元组(tuple)，输入一般来源于文件或者网络的二进制流，模块主要包括函数struct.pack()和struct.unpack()。 struct.pack(fmt,v1,v2,.....)，将v1,v2等参数的值进行一层包装，包装的方法由fmt指定。被包装的参数必须严格符合fmt。最后返回一个包装后的字符串。 struct.unpack(fmt,string)，返回一个由解包数据(string)得到的一个元组(tuple), 即使仅有一个数据也会被解包成元组。其中len(string) 必须等于 calcsize(fmt)，用到了struct.calcsize()函数。 import struct buffer = struct.pack("ihb", 1, 2, 3) print repr(buffer) print struct.unpack("ihb", buffer) data = \[1, 2, 3\] buffer = struct.pack("!ihb", *data) print repr(buffer) print struct.unpack("!ihb", buffer) Output: '\\x01\\x00\\x00\\x00\\x02\\x00\\x03' (1, 2, 3) '\\x00\\x00\\x00\\x01\\x00\\x02\\x03' (1, 2, 3) 其中的fmt参数"ihb"分别表示： i 代表C语言struct中的int类型，占4位，表示为 01000000（小端） h 代表C语言struct中的short类型，占2位，故表示为 0200 b 代表C语言struct中的signed char类型，占1位，故表示为 03 默认对齐方式同本地一致，“！”指定内存对齐方式为网络模式=大端模式，“<”指定小端模式，“>”指定大端模式。 repr() 函数将对象转化为供解释器读取的形式，出来的值是给机器看的，括号中的任何内容出来后都是在它之上再加上一层引号。类似的显示函数str()则把值转换为合理形式的字符串，输出给用户看。