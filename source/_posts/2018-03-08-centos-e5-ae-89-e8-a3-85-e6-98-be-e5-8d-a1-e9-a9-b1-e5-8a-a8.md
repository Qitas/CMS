---
title: centos安装显卡驱动
url: 1073.html
id: 1073
categories:
  - IT·Q
tags:
  - centos
---

centos没有ubuntu那样方便快捷的显卡驱动设置，要正确在centos7上安装nvidia显卡驱动，就必须先禁用linux本身的显卡驱动，网上教程很多但多有糟粕其中，我总结一下实践结果。 大多是说在/etc/modprobe.d/blacklist.conf 在后面加入：blacklist nouveau 其实centos7没有/etc/modprobe.d/blacklist.conf文件，所以通过指令新建添加 echo -e "blacklist nouveau\\noptions nouveau modeset=0" > /etc/modprobe.d/blacklist.conf 但只在/etc/modprobe.d/blacklist.conf 加入上述内容并reboot后，会发现还是没有禁用nouveau，通过lsmod | grep nouveau查看还有很多项 还有说在/etc/modprobe.d/blacklist.conf中增删 blacklist vga16fb blacklist nouveau blacklist rivafb blacklist nvidiafb blacklist rivatv 其实上面的文件都在/usr/lib/modprobe.d/dist-blacklist.conf中，我们实际要添加的两行 blacklist nouveau 和 options nouveau modeset=0也是在该文件中添加。 同时还要注释掉对nvidia的屏蔽blacklist nvidiafb 再进行其他不重要的事如：习惯性备份 $ sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak 使用dracut重新建立 initramfs image file $ sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r) 重启reboot，这是关键的一步，不然屏蔽还没生效，立即安装报错。 重启系统后可以发现分辨率变化了，表示屏蔽生效，lsmod | grep nouveau验证以下也没有东西了，此时init 3切换到文本模式安装官方下载的run文件了。 很多人在过程中通过systemctl set-default multi-user.target设置了文本启动项目，重启后不需要init 3了。但是在装完驱动后，系统还是没有切换到图形界面。 此时，切换图形模式init 5，修改/etc/inittab中启动模式设置 multi-user.target: analogous to runlevel 3 #命令行模式 graphical.target: analogous to runlevel 5 #图形模式 centos只有上述两种启动模式,通过systemctl get-default 命令获取当前的模式 通过systemctl set-default graphical.target 命令修改启动模式，也是重启生效